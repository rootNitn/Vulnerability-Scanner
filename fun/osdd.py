import fun.traceroute

from scapy.layers.inet import IP, ICMP, sr1
def osd(target):
    pack = IP(dst=target)/ICMP()
    resp = sr1(pack,timeout=2)
    if resp == None:
        print("No Response:- Can not find server information")
    elif IP in resp:
        if resp.getlayer(IP).ttl <= 64:
            os = "Linux"
            hop = 64 - resp.getlayer(IP).ttl
            print("Network distance - " + str(hop))
            print("Trace route : --")
            fun.traceroute.tracert(target,hop)
        else:
            os = "Windows"
            hop = 128 - resp.getlayer(IP).ttl
            print("Network distance - " + str(hop))
            print("Trace route : --")
            fun.traceroute.tracert(target, hop)
        print("Server OS :- "+ os)