from scapy.layers.inet import IP, ICMP, sr1,TCP,sr
from scapy.volatile import RandShort
def tracert(target,hop):
    res, unans = sr(IP(dst=target, ttl=(1, hop)) / TCP(sport=RandShort()))
    res.make_table(lambda s, r: (s.dst, s.ttl, r.sprintf("%IP.src% \t {TCP:%TCP.flags%}")))