import sys
import random
import ipwhois
import pyfiglet
import fun.subdomains
import fun.port
import fun.path
import fun.sql
#import fun.dns
import socket
import fun.banner
import fun.ftp
import fun.web
import fun.admin
class color:
    HEADER = '\033[95m'
    IMPORTANT = '\33[35m'
    NOTICE = '\033[33m'
    OKBLUE = '\033[94m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    RED = '\033[91m'
    END = '\033[0m'
    UNDERLINE = '\033[4m'
    LOGGING = '\33[34m'


ascii_banner = pyfiglet.figlet_format("VSTK SCANNER")
color_random = [color.HEADER, color.IMPORTANT, color.NOTICE, color.OKBLUE, color.OKGREEN, color.WARNING, color.RED,
                    color.END, color.UNDERLINE, color.LOGGING]
logo = random.choice(color_random) + ascii_banner
print(logo)
print("-----------------Welcome to VSTK----------------------")
print("1:- Scan Local Server")
print("2:- Scan Websites")
print("3:- Port Scan")
print("4:- Network Scan")
print("5:- For kali linux")
print("6:- Exit")
n = int(input('Enter your choice:- '))
portarr = []
patharr = []
ba = '-'
if n == 1:
    target = input('Enter the host to be scanned: ')
    print("1:- single port scan")
    print("2:- Range of port scan")
    temp = int(input('Enter the choice: '))

    if temp == 1:
        portt = int(input("Enter the port no"))
        lport = portt
        rport = portt
        fun.port.port(target,portarr)
    elif temp == 2:
            #lport = int(input('Enter the first port range: '))
            #rport = int(input('Enter the second port range: '))
        fun.port.port(target,portarr)
    else:
        print("Incorrect Input")
elif n == 2:
    print("1:- Subdomains")
    print("2:- URL Paths")
    print("3:- Sql injection")
    print("4:- Whois")
    print("5:- All ")
    print("6:- Back")
    k = int(input("Enter Your choice  "))
    if k == 1:
        url = input('Enter the url ex(google.com)(Do not use prefix):- ')
        fun.subdomains.funn(url)
    elif k == 2:
        url = input('Enter the url ex(www.iiitm.ac.in/)(write whole web address):- ')
        url = "http://" + url
        fun.path.pathfinder(url,patharr)
    elif k == 3:
        k = input("Are you use DVWA(for local server) :- Y/N -")
        if k == 'Y':
            fun.sql.Sql.Dvwa()
            url = input("Enter the url :- ")
            fun.sql.Sql.scan_sql_injection(url)
        elif k == 'N':
            url = input("Enter the url :- ")
            fun.sql.Sql.scan_sql_injection(url)
    elif k == 4:
        ip = input('\033[36mEnter target ip: \033[0m')
        print('----------- WHOIS INFORMATION ---------------------')
        RESULT = ipwhois.IPWhois(ip).lookup_whois()
        print(RESULT)
    elif k == 5:
        url1 = input('Enter the url ex(google.com)(Do not use prefix):- ')
        url = 'http://' + url1
        print(ba*20 + ' WHOIS INFORMATION ' +ba*20)
        ip_address = socket.gethostbyname(url1)
        RESULT = ipwhois.IPWhois(ip_address).lookup_whois()
        kk = RESULT['nets'][0]
        for i in kk:
            print(i, kk[i])
        for i in RESULT:
            if i == 'nets':
                pass
            else:
                print(i, RESULT[i])
        #fun.dns.kk(url1)
        print(ba*20 + ' OPEN PORT INFORMATION '+ba*20)
        temp = fun.port.port(ip_address,portarr)
        print(temp)
        for i in temp:
            print("Open port are -- " + str(i))
            if i == 21:
                fun.ftp.ftpvu(ip_address)
        fun.banner.banner(ip_address,temp)
        print(ba*20 + ' HEADER INFORMATION' + ba*20)
        fun.banner.header(url1)
        fun.web.web(url)
        print(ba*20 + " ADMIN PAGE " + ba*20)
        fun.admin.admin(url)
        print(ba*20 + " Scanning for path "+ ba*20)
        fun.path.pathfinder(url,patharr)
        print(ba*20 + " Scanning for subdomain "+ ba*20)
        fun.subdomains.funn(url1)
        print(ba*20 + " SQL INJECTION DETECTION " + ba*20)
        fun.sql.Sql.scan_sql_injection(url1)
    else:
        print("Wrong input")

elif n == 3:
    pass
elif n== 4:
    pass
elif n == 5:
    pass
elif n == 6:
    sys.exit()
else:
    print("Wrong input")